{"ast":null,"code":"var express = require(\"express\");\n\nconst router = express.Router();\n\nvar db = require(\"../dbseed\");\n\nvar multer = require(\"multer\");\n\nvar storage = multer.diskStorage({\n  destination: function (req, file, cb) {\n    cb(null, \"public/company\");\n  },\n  filename: function (req, file, cb) {\n    cb(null, Date.now() + \"-\" + file.originalname);\n  }\n});\nvar upload = multer({\n  storage: storage\n}).single(\"file\");\nrouter.post(\"/uploadCompanyPicture\", function (req, res) {\n  //var sql = `UPDATE CompanyData SET location='${req.body.location}', phoneno='${req.body.phoneno}', emailcontact='${req.body.emailcontact}', fax='${req.body.fax}', website='${req.body.website}', description='${req.body.description}', companytype='${req.body.companytype}' WHERE email='${req.body.authemail}'`;\n  //   db.query(sql, (err, rows, fields) => {\n  //     // if (err) throw err;\n  //     if (err) {\n  //       res.status(400).send(\"Some error occured...Please try again!!!\");\n  //     } else {\n  //       console.log(\"1 record inserted\");\n  //       //res.status(200).send({ email: req.body.email, token: token });\n  //       res.status(200).send({ success: true });\n  //     }\n  //   });\n  // const entries = [...data.entries()];\n  //console.log(req.file);\n  upload(req, res, function (err) {\n    if (err instanceof multer.MulterError) {\n      return res.status(500).json(err);\n    } else if (err) {\n      return res.status(500).json(err);\n    }\n\n    console.log(req.file);\n    return res.status(200).send(req.file.path);\n  });\n});\nmodule.exports = router;","map":{"version":3,"sources":["/Users/surbhi/Documents/STUDY/CMPE273/Projects/Handshake/backend/Routes/uploadCompanyPicture.js"],"names":["express","require","router","Router","db","multer","storage","diskStorage","destination","req","file","cb","filename","Date","now","originalname","upload","single","post","res","err","MulterError","status","json","console","log","send","path","module","exports"],"mappings":"AAAA,IAAIA,OAAO,GAAGC,OAAO,CAAC,SAAD,CAArB;;AACA,MAAMC,MAAM,GAAGF,OAAO,CAACG,MAAR,EAAf;;AACA,IAAIC,EAAE,GAAGH,OAAO,CAAC,WAAD,CAAhB;;AACA,IAAII,MAAM,GAAGJ,OAAO,CAAC,QAAD,CAApB;;AAEA,IAAIK,OAAO,GAAGD,MAAM,CAACE,WAAP,CAAmB;AAC/BC,EAAAA,WAAW,EAAE,UAASC,GAAT,EAAcC,IAAd,EAAoBC,EAApB,EAAwB;AACnCA,IAAAA,EAAE,CAAC,IAAD,EAAO,gBAAP,CAAF;AACD,GAH8B;AAI/BC,EAAAA,QAAQ,EAAE,UAASH,GAAT,EAAcC,IAAd,EAAoBC,EAApB,EAAwB;AAChCA,IAAAA,EAAE,CAAC,IAAD,EAAOE,IAAI,CAACC,GAAL,KAAa,GAAb,GAAmBJ,IAAI,CAACK,YAA/B,CAAF;AACD;AAN8B,CAAnB,CAAd;AAQA,IAAIC,MAAM,GAAGX,MAAM,CAAC;AAAEC,EAAAA,OAAO,EAAEA;AAAX,CAAD,CAAN,CAA6BW,MAA7B,CAAoC,MAApC,CAAb;AAEAf,MAAM,CAACgB,IAAP,CAAY,uBAAZ,EAAqC,UAAST,GAAT,EAAcU,GAAd,EAAmB;AACtD;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACAH,EAAAA,MAAM,CAACP,GAAD,EAAMU,GAAN,EAAW,UAASC,GAAT,EAAc;AAC7B,QAAIA,GAAG,YAAYf,MAAM,CAACgB,WAA1B,EAAuC;AACrC,aAAOF,GAAG,CAACG,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBH,GAArB,CAAP;AACD,KAFD,MAEO,IAAIA,GAAJ,EAAS;AACd,aAAOD,GAAG,CAACG,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBH,GAArB,CAAP;AACD;;AACDI,IAAAA,OAAO,CAACC,GAAR,CAAYhB,GAAG,CAACC,IAAhB;AAEA,WAAOS,GAAG,CAACG,MAAJ,CAAW,GAAX,EAAgBI,IAAhB,CAAqBjB,GAAG,CAACC,IAAJ,CAASiB,IAA9B,CAAP;AACD,GATK,CAAN;AAUD,CA1BD;AA4BAC,MAAM,CAACC,OAAP,GAAiB3B,MAAjB","sourcesContent":["var express = require(\"express\");\nconst router = express.Router();\nvar db = require(\"../dbseed\");\nvar multer = require(\"multer\");\n\nvar storage = multer.diskStorage({\n  destination: function(req, file, cb) {\n    cb(null, \"public/company\");\n  },\n  filename: function(req, file, cb) {\n    cb(null, Date.now() + \"-\" + file.originalname);\n  }\n});\nvar upload = multer({ storage: storage }).single(\"file\");\n\nrouter.post(\"/uploadCompanyPicture\", function(req, res) {\n  //var sql = `UPDATE CompanyData SET location='${req.body.location}', phoneno='${req.body.phoneno}', emailcontact='${req.body.emailcontact}', fax='${req.body.fax}', website='${req.body.website}', description='${req.body.description}', companytype='${req.body.companytype}' WHERE email='${req.body.authemail}'`;\n\n  //   db.query(sql, (err, rows, fields) => {\n  //     // if (err) throw err;\n  //     if (err) {\n  //       res.status(400).send(\"Some error occured...Please try again!!!\");\n  //     } else {\n  //       console.log(\"1 record inserted\");\n  //       //res.status(200).send({ email: req.body.email, token: token });\n  //       res.status(200).send({ success: true });\n  //     }\n  //   });\n\n  // const entries = [...data.entries()];\n  //console.log(req.file);\n  upload(req, res, function(err) {\n    if (err instanceof multer.MulterError) {\n      return res.status(500).json(err);\n    } else if (err) {\n      return res.status(500).json(err);\n    }\n    console.log(req.file);\n\n    return res.status(200).send(req.file.path);\n  });\n});\n\nmodule.exports = router;\n"]},"metadata":{},"sourceType":"script"}